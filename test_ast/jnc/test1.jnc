//.............................................................................

class IScheduler
{
	abstract 
	Schedule (function* pfn ());
};

//. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

class CNewThreadScheduler: IScheduler
{
	override
	Schedule (function* pfn ())
	{
		printf ("CNewThreadScheduler.Schedule ()\n");
		CreateThread (pfn);
	}
};

//.............................................................................

foo (int x)
{
	printf ("foo (%d) TID: %d\n", x, GetCurrentThreadId ());
}

int 
main ()
{
	printf ("main () TID: %d\n", GetCurrentThreadId ());

	foo (5);

	IScheduler s = stack new CNewThreadScheduler;

	(foo @ s) (10);

	return 0;
}
 
//.............................................................................

int
printf (
	unsafe const char* pFormat,
	unsafe ...
	);

int
GetCurrentThreadId ();

bool
CreateThread (function* pfn ());

//.............................................................................
